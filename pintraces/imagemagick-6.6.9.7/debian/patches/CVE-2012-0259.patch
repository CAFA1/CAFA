Description: fix denial of service and possible code execution via EXIF tags.
Origin: backport, http://trac.imagemagick.org/changeset/7249
Origin: upstream, http://trac.imagemagick.org/changeset/7255

Index: imagemagick-6.6.9.7/coders/tiff.c
===================================================================
--- imagemagick-6.6.9.7.orig/coders/tiff.c	2012-04-25 11:25:50.898295721 -0400
+++ imagemagick-6.6.9.7/coders/tiff.c	2012-04-25 11:25:56.702295869 -0400
@@ -595,7 +595,7 @@
           *ascii;
 
         if (TIFFGetField(tiff,exif_info[i].tag,&ascii) != 0)
-          (void) CopyMagickMemory(value,ascii,MaxTextExtent);
+          (void) CopyMagickString(value,ascii,MaxTextExtent);
         break;
       }
       case TIFF_SHORT:
Index: imagemagick-6.6.9.7/magick/property.c
===================================================================
--- imagemagick-6.6.9.7.orig/magick/property.c	2012-04-25 11:25:56.682295869 -0400
+++ imagemagick-6.6.9.7/magick/property.c	2012-04-25 11:25:56.702295869 -0400
@@ -1325,6 +1325,8 @@
             buffer[MaxTextExtent],
             *value;
 
+          value=(char *) NULL;
+          *buffer='\0';
           switch (format)
           {
             case EXIF_FMT_BYTE:
